# like topo sort, keep cutting edges